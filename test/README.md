# DbRheo æµ‹è¯•æ–‡æ¡£

## ğŸ“ ç›®å½•ç»“æ„

```
test/
â”œâ”€â”€ README.md                    # æœ¬æ–‡ä»¶ï¼ˆæµ‹è¯•æ–‡æ¡£ï¼‰
â”œâ”€â”€ verify_test_setup.py         # ç¯å¢ƒéªŒè¯è„šæœ¬
â”œâ”€â”€ run_baseline_test.py         # Baselineå®Œæ•´æµ‹è¯•ï¼ˆ100é¢˜ï¼‰
â”œâ”€â”€ quick_baseline_test.py       # Baselineå¿«é€Ÿæµ‹è¯•ï¼ˆå‰Né¢˜ï¼‰
â”œâ”€â”€ run_benchmark.py             # Benchmarkæµ‹è¯•è„šæœ¬
â”œâ”€â”€ quick_test_benchmark.py      # Benchmarkå¿«é€Ÿæµ‹è¯•
â”œâ”€â”€ diagnose_data.py             # æ•°æ®è¯Šæ–­å·¥å…·
â”œâ”€â”€ test_evaluation.py           # è¯„ä¼°ç®¡ç†å™¨å•å…ƒæµ‹è¯•
â”œâ”€â”€ test_new_features.py         # è¯„ä¼°åŠŸèƒ½é«˜çº§æµ‹è¯•
â”œâ”€â”€ question/                    # æµ‹è¯•é—®é¢˜é›†
â”‚   â”œâ”€â”€ automotive_questions_list_100.csv      # 100ä¸ªæµ‹è¯•é—®é¢˜
â”‚   â””â”€â”€ benchmark_100_questions_final.csv      # Benchmarké—®é¢˜é›†
â”œâ”€â”€ answer/                      # æ ‡å‡†ç­”æ¡ˆ
â”‚   â””â”€â”€ automotive_answers_100.csv             # 100ä¸ªæ ‡å‡†ç­”æ¡ˆ
â””â”€â”€ result/                      # æµ‹è¯•ç»“æœè¾“å‡ºç›®å½•
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. éªŒè¯ç¯å¢ƒ

é¦–å…ˆè¿è¡ŒéªŒè¯è„šæœ¬ï¼Œç¡®ä¿æ‰€æœ‰æ–‡ä»¶å’Œä¾èµ–éƒ½æ­£ç¡®é…ç½®ï¼š

```bash
cd test
python verify_test_setup.py
```

### 2. è¿è¡Œ Baseline æµ‹è¯•

**å¿«é€Ÿæµ‹è¯•ï¼ˆå‰3é¢˜ï¼‰**ï¼š
```bash
python quick_baseline_test.py
```

**å®Œæ•´æµ‹è¯•ï¼ˆ100é¢˜ï¼‰**ï¼š
```bash
python run_baseline_test.py
```

### 3. è¿è¡Œ Benchmark æµ‹è¯•

```bash
python run_benchmark.py
```

## ğŸ“Š æµ‹è¯•è„šæœ¬å¯¹æ¯”

| è„šæœ¬ | æµ‹è¯•æ•°é‡ | è¿è¡Œæ—¶é—´ | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|---------|
| `quick_baseline_test.py` | å‰3é¢˜ï¼ˆå¯ä¿®æ”¹ï¼‰ | ~10-15ç§’ | å¿«é€ŸéªŒè¯ã€è°ƒè¯• |
| `run_baseline_test.py` | å…¨éƒ¨100é¢˜ | ~4-5åˆ†é’Ÿ | å®Œæ•´æµ‹è¯•ã€æ€§èƒ½è¯„ä¼° |
| `quick_test_benchmark.py` | å‰3é¢˜ | ~10-15ç§’ | Benchmarkå¿«é€Ÿæµ‹è¯• |
| `run_benchmark.py` | å…¨éƒ¨100é¢˜ | ~4-5åˆ†é’Ÿ | Benchmarkå®Œæ•´æµ‹è¯• |

## ğŸ“ è¾“å‡ºæ–‡ä»¶è¯´æ˜

### Baseline æµ‹è¯•è¾“å‡º

æµ‹è¯•ç»“æœä¿å­˜åœ¨ `result/` ç›®å½•ï¼š

```
result/
â”œâ”€â”€ baseline_log_YYYYMMDD_HHMMSS.json      # å®Œæ•´å¯¹è¯æ—¥å¿—ï¼ˆJSONLï¼‰
â”œâ”€â”€ baseline_results_YYYYMMDD_HHMMSS.json  # æµ‹è¯•ç»“æœ
â”œâ”€â”€ baseline_summary_YYYYMMDD_HHMMSS.json  # æ‘˜è¦æŠ¥å‘Š
â”œâ”€â”€ quick_test_log_YYYYMMDD_HHMMSS.json    # å¿«é€Ÿæµ‹è¯•å¯¹è¯æ—¥å¿—
â””â”€â”€ quick_test_results_YYYYMMDD_HHMMSS.json # å¿«é€Ÿæµ‹è¯•ç»“æœ
```

**æ³¨æ„**ï¼šæ‰€æœ‰æ—¥å¿—æ–‡ä»¶éƒ½å¸¦æ—¶é—´æˆ³ï¼Œæ¯æ¬¡è¿è¡Œéƒ½ä¼šåˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¸ä¼šè¦†ç›–ä¹‹å‰çš„æµ‹è¯•ç»“æœã€‚

### Benchmark æµ‹è¯•è¾“å‡º

```
result/
â”œâ”€â”€ benchmark_results.json       # è¯¦ç»†ç»“æœï¼ˆJSONï¼‰
â”œâ”€â”€ benchmark_results.csv        # è¯¦ç»†ç»“æœï¼ˆCSVï¼‰
â”œâ”€â”€ benchmark_summary.json       # ç»Ÿè®¡æ‘˜è¦
â”œâ”€â”€ benchmark_report.md          # MarkdownæŠ¥å‘Š
â””â”€â”€ benchmark_detailed.log       # è¯¦ç»†æ—¥å¿—
```

## ğŸ“‹ æ—¥å¿—æ ¼å¼

### 1. å¯¹è¯æ—¥å¿—ï¼ˆJSONLæ ¼å¼ï¼‰

æ¯è¡Œä¸€ä¸ªJSONå¯¹è±¡ï¼Œè®°å½•å®Œæ•´çš„å¯¹è¯è¿‡ç¨‹ï¼š

```json
{"timestamp": "2026-01-13T16:32:35.833746", "role": "user", "content": "2023-06ï¼Œä¸€æ±½å¤§ä¼—æ½å¢ƒçš„é”€é‡æ˜¯å¤šå°‘ï¼Ÿ"}
{"timestamp": "2026-01-13T16:32:36.123456", "role": "model", "content": "è®©æˆ‘æŸ¥è¯¢2023å¹´6æœˆä¸€æ±½å¤§ä¼—æ½å¢ƒçš„é”€é‡æ•°æ®ã€‚"}
{"timestamp": "2026-01-13T16:32:36.987654", "role": "model", "content": "ã€ç­”æ¡ˆï¼š4045 è¾†ã€‘"}
```

### 2. æµ‹è¯•ç»“æœï¼ˆJSONæ ¼å¼ï¼‰

åŒ…å«æ¯ä¸ªæµ‹è¯•çš„è¯¦ç»†ä¿¡æ¯ï¼š

```json
{
  "test_num": 1,
  "test_id": "Q1",
  "question": "2023-06ï¼Œä¸€æ±½å¤§ä¼—æ½å¢ƒçš„é”€é‡æ˜¯å¤šå°‘ï¼Ÿ",
  "success": true,
  "predicted_answer": "ã€ç­”æ¡ˆï¼š4045 è¾†ã€‘",
  "filtered_rows": 1,
  "execution_time": 2.45,
  "tokens_input": 1234,
  "tokens_output": 567,
  "tokens_total": 1801,
  "error": null
}
```

### 3. æ‘˜è¦æŠ¥å‘Šï¼ˆJSONæ ¼å¼ï¼‰

æ€»ä½“ç»Ÿè®¡ä¿¡æ¯ï¼š

```json
{
  "total_tests": 100,
  "successful_tests": 85,
  "success_rate": "85.00%",
  "total_tokens": 150000,
  "avg_tokens": "1500",
  "total_time": "250.5s",
  "avg_time": "2.51s",
  "generated_at": "2026-01-13T16:45:30.123456"
}
```

## ğŸ”§ é…ç½®è¦æ±‚

### ç¯å¢ƒå˜é‡

ç¡®ä¿ `.env` æ–‡ä»¶ä¸­é…ç½®äº†ä»¥ä¸‹å˜é‡ï¼š

```bash
# Baseline å®éªŒé…ç½®
BASELINE_OPENAI_API_KEY=your_api_key
BASELINE_OPENAI_API_BASE=https://dashscope.aliyuncs.com/compatible-mode/v1
BASELINE_MODEL=qwen-flash
BASELINE_CSV_PATH=æ•°æ®æº_é”€é‡.csv
```

### Pythonä¾èµ–

```bash
pip install pandas python-dotenv openai
```

## ğŸ“ˆ æµ‹è¯•è¿›åº¦æ˜¾ç¤º

æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæ¯å®Œæˆ10ä¸ªé—®é¢˜ä¼šæ˜¾ç¤ºè¿›åº¦ä¿¡æ¯ï¼š

```
ğŸ“ˆ è¿›åº¦: 10/100 (10.0%)
   å·²ç”¨æ—¶é—´: 25.3ç§’
   å¹³å‡è€—æ—¶: 2.53ç§’/é¢˜
   é¢„è®¡å‰©ä½™: 227.7ç§’
```

## ğŸ› ï¸ å·¥å…·è„šæœ¬

### verify_test_setup.py

éªŒè¯æµ‹è¯•ç¯å¢ƒæ˜¯å¦æ­£ç¡®é…ç½®ï¼š
- æ£€æŸ¥å¿…è¦æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- æ£€æŸ¥Pythonä¾èµ–æ˜¯å¦å®‰è£…
- æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦é…ç½®

### diagnose_data.py

æ•°æ®è¯Šæ–­å·¥å…·ï¼Œç”¨äºåˆ†ææµ‹è¯•æ•°æ®è´¨é‡å’Œé—®é¢˜ã€‚

### test_evaluation.py

è¯„ä¼°ç®¡ç†å™¨ï¼ˆEvaluationManagerï¼‰çš„å•å…ƒæµ‹è¯•ï¼Œæµ‹è¯•åŸºç¡€åŠŸèƒ½ï¼š
- ç­”æ¡ˆæå–
- ç­”æ¡ˆæ¯”è¾ƒ
- è¯„ä¼°è®°å½•æ·»åŠ 
- DataFrameç”Ÿæˆ
- ç»Ÿè®¡ä¿¡æ¯
- CSVå¯¼å‡º

è¿è¡Œï¼š`python test_evaluation.py`

### test_new_features.py

è¯„ä¼°ç®¡ç†å™¨çš„é«˜çº§åŠŸèƒ½æµ‹è¯•ï¼š
- åŒä¸€é—®é¢˜å¤šæ¬¡è¿è¡Œ
- é—®é¢˜æŒ‡çº¹ç”Ÿæˆ
- æŒ‰Agentåˆ†ç±»ç»Ÿè®¡
- ç­›é€‰åŠŸèƒ½
- é—®é¢˜æœç´¢
- é—®é¢˜è¯¦æƒ…æŸ¥è¯¢

è¿è¡Œï¼š`python test_new_features.py`

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **APIè´¹ç”¨**ï¼šæ¯ä¸ªé—®é¢˜ä¼šè°ƒç”¨LLM APIï¼Œæ³¨æ„APIé…é¢å’Œè´¹ç”¨
2. **æµ‹è¯•æ—¶é—´**ï¼š100ä¸ªé—®é¢˜å¤§çº¦éœ€è¦4-5åˆ†é’Ÿï¼ˆå–å†³äºç½‘ç»œå’ŒAPIå“åº”é€Ÿåº¦ï¼‰
3. **æ—¥å¿—ç›®å½•**ï¼šç¡®ä¿ `result/` ç›®å½•æœ‰å†™å…¥æƒé™
4. **ç½‘ç»œè¿æ¥**ï¼šéœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥è®¿é—®LLM API
5. **æ–‡ä»¶è¦†ç›–**ï¼šæ‰€æœ‰æ—¥å¿—æ–‡ä»¶å¸¦æ—¶é—´æˆ³ï¼Œä¸ä¼šè¦†ç›–æ—§æ–‡ä»¶

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šå¯¼å…¥å¤±è´¥

```
è­¦å‘Š: æ— æ³•å¯¼å…¥baseline_agent_enhanced
```

**è§£å†³**ï¼šæ£€æŸ¥è·¯å¾„è®¾ç½®ï¼Œç¡®ä¿åœ¨æ­£ç¡®çš„ç›®å½•ä¸‹è¿è¡Œè„šæœ¬

### é—®é¢˜2ï¼šAPIè®¤è¯é”™è¯¯

```
é”™è¯¯: Authentication error
```

**è§£å†³**ï¼šæ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `BASELINE_OPENAI_API_KEY` æ˜¯å¦æ­£ç¡®

### é—®é¢˜3ï¼šæ‰¾ä¸åˆ°CSVæ–‡ä»¶

```
âŒ CSVæ–‡ä»¶ä¸å­˜åœ¨
```

**è§£å†³**ï¼šç¡®ä¿ `baseline/æ•°æ®æº_é”€é‡.csv` æ–‡ä»¶å­˜åœ¨

### é—®é¢˜4ï¼šæ—¥å¿—æ–‡ä»¶å†™å…¥å¤±è´¥

```
âŒ ä¿å­˜ç»“æœå¤±è´¥: Permission denied
```

**è§£å†³**ï¼šæ£€æŸ¥ `result/` ç›®å½•æ˜¯å¦å­˜åœ¨ä¸”æœ‰å†™å…¥æƒé™

## ğŸ—‘ï¸ æ¸…ç†æ—§æ—¥å¿—

```bash
# æ¸…ç†æ‰€æœ‰å¿«é€Ÿæµ‹è¯•æ—¥å¿—
rm result/quick_test_*.json

# æ¸…ç†æ‰€æœ‰å®Œæ•´æµ‹è¯•æ—¥å¿—
rm result/baseline_*.json

# æ¸…ç†7å¤©å‰çš„æ—¥å¿—
find result -name "*.json" -mtime +7 -delete

# åªä¿ç•™æœ€æ–°çš„3ä¸ªæµ‹è¯•ç»“æœ
ls -t result/*log*.json | tail -n +4 | xargs rm
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å¼€å‘é˜¶æ®µ**ï¼šä½¿ç”¨ `quick_baseline_test.py`ï¼ˆä¿®æ”¹NUM_TEST=1æˆ–2ï¼‰
2. **æµ‹è¯•é˜¶æ®µ**ï¼šä½¿ç”¨ `quick_baseline_test.py`ï¼ˆNUM_TEST=10æˆ–20ï¼‰
3. **è¯„ä¼°é˜¶æ®µ**ï¼šä½¿ç”¨ `run_baseline_test.py`ï¼ˆå®Œæ•´100ä¸ªé—®é¢˜ï¼‰
4. **å½’æ¡£**ï¼šå®šæœŸæ¸…ç†æ—§çš„ç»“æœæ–‡ä»¶ï¼Œåªä¿ç•™å…³é”®æµ‹è¯•çš„æ—¥å¿—

## ğŸ“š æµ‹è¯•é—®é¢˜é›†

### automotive_questions_list_100.csv

åŒ…å«100ä¸ªæ±½è½¦é”€é‡ç›¸å…³çš„æµ‹è¯•é—®é¢˜ï¼Œè¦†ç›–ï¼š
- åŸºç¡€å–æ•°ï¼ˆæœˆé”€é‡ã€å¹´é”€é‡ï¼‰
- æ—¶é—´åŒºé—´æŸ¥è¯¢
- åŒæ¯”/ç¯æ¯”å¢é•¿
- å“ç‰Œ/è½¦å‹å¯¹æ¯”
- æ’åæŸ¥è¯¢
- è¾¹ç•Œæµ‹è¯•

### automotive_answers_100.csv

å¯¹åº”çš„100ä¸ªæ ‡å‡†ç­”æ¡ˆï¼Œæ ¼å¼ï¼š
```
é—®é¢˜ï¼š2023-06ï¼Œä¸€æ±½å¤§ä¼—æ½å¢ƒçš„é”€é‡æ˜¯å¤šå°‘ï¼Ÿ
ç­”æ¡ˆï¼š4045
```

## ğŸ¯ è¯„åˆ†æ ‡å‡†

- **å®Œå…¨æ­£ç¡®**ï¼šé¢„æµ‹å€¼ä¸æ ‡å‡†ç­”æ¡ˆè¯¯å·® < 1%
- **å‡†ç¡®ç‡** = æ­£ç¡®æ•° / æ€»é—®é¢˜æ•° Ã— 100%

## ğŸ“ ä¸‹ä¸€æ­¥

è¿è¡Œæµ‹è¯•åï¼š
1. æŸ¥çœ‹ `result/baseline_summary_*.json` äº†è§£æ€»ä½“è¡¨ç°
2. æŸ¥çœ‹ `result/baseline_results_*.json` åˆ†æå…·ä½“é—®é¢˜
3. æŸ¥çœ‹ `result/baseline_log_*.json` æŸ¥çœ‹è¯¦ç»†å¯¹è¯æ—¥å¿—
4. æ ¹æ®ç»“æœä¼˜åŒ–promptæˆ–è®¡ç®—é€»è¾‘

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼** ğŸ‰
